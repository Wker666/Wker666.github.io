<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('http://yoursite.com').hostname,
    root: '/',
    scheme: 'Muse',
    version: '7.7.0',
    exturl: false,
    sidebar: {"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta name="description" content="CTF入门题昨天下午在宿舍没有太多事做，就在耍手机，有个朋友说他参加了个CTF比赛，但是逆向的题目不太会，想找我帮忙看看，我正想着反正也没啥事，而且他说参加的是MRCTF，一个青少年的CTF比赛，这类的题目应该是十分钟一个的，并且他给我发的说还是入门题目，我就想着多多少少帮忙看看吧，故事就开始了。 exe逆向搞exe逆向我自认为已经是快到头了（自认为的），就想着快点搞完，他就给我发过来了，用查壳的">
<meta property="og:type" content="article">
<meta property="og:title" content="CTF入门题">
<meta property="og:url" content="http://yoursite.com/2021/04/11/CTF%E5%85%A5%E9%97%A8%E9%A2%98/index.html">
<meta property="og:site_name" content="Wker">
<meta property="og:description" content="CTF入门题昨天下午在宿舍没有太多事做，就在耍手机，有个朋友说他参加了个CTF比赛，但是逆向的题目不太会，想找我帮忙看看，我正想着反正也没啥事，而且他说参加的是MRCTF，一个青少年的CTF比赛，这类的题目应该是十分钟一个的，并且他给我发的说还是入门题目，我就想着多多少少帮忙看看吧，故事就开始了。 exe逆向搞exe逆向我自认为已经是快到头了（自认为的），就想着快点搞完，他就给我发过来了，用查壳的">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://yoursite.com/2021/04/11/CTF%E5%85%A5%E9%97%A8%E9%A2%98/1.jpg">
<meta property="og:image" content="http://yoursite.com/2021/04/11/CTF%E5%85%A5%E9%97%A8%E9%A2%98/3.jpg">
<meta property="article:published_time" content="2021-04-11T09:50:38.000Z">
<meta property="article:modified_time" content="2021-04-11T10:58:29.431Z">
<meta property="article:author" content="Wker">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://yoursite.com/2021/04/11/CTF%E5%85%A5%E9%97%A8%E9%A2%98/1.jpg">

<link rel="canonical" href="http://yoursite.com/2021/04/11/CTF%E5%85%A5%E9%97%A8%E9%A2%98/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true
  };
</script>

  <title>CTF入门题 | Wker</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Wker</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">计算机安全</p>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-首页">

    <a href="/" rel="section"><i class="fa fa-fw fa-首页"></i>首页</a>

  </li>
        <li class="menu-item menu-item-标签">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-标签"></i>标签</a>

  </li>
        <li class="menu-item menu-item-分类">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-分类"></i>分类</a>

  </li>
        <li class="menu-item menu-item-文章">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-文章"></i>文章</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="Searching..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="en">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2021/04/11/CTF%E5%85%A5%E9%97%A8%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/Image.JPG">
      <meta itemprop="name" content="Wker">
      <meta itemprop="description" content="一个萌新">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Wker">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          CTF入门题
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2021-04-11 17:50:38 / Modified: 18:58:29" itemprop="dateCreated datePublished" datetime="2021-04-11T17:50:38+08:00">2021-04-11</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index">
                    <span itemprop="name">CTF</span>
                  </a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="CTF入门题"><a href="#CTF入门题" class="headerlink" title="CTF入门题"></a>CTF入门题</h1><p>昨天下午在宿舍没有太多事做，就在耍手机，有个朋友说他参加了个CTF比赛，但是逆向的题目不太会，想找我帮忙看看，我正想着反正也没啥事，而且他说参加的是MRCTF，一个青少年的CTF比赛，这类的题目应该是十分钟一个的，并且他给我发的说还是入门题目，我就想着多多少少帮忙看看吧，故事就开始了。</p>
<h2 id="exe逆向"><a href="#exe逆向" class="headerlink" title="exe逆向"></a>exe逆向</h2><p>搞exe逆向我自认为已经是快到头了（自认为的），就想着快点搞完，他就给我发过来了，用查壳的一查是个UPX的，手头没有脱壳机，我就手拖一下吧。<br><img src="1.jpg" alt="exe"><br>可以看到是一个大跳转，然后一直跟下去，发现貌似是加花混淆了的，而且处在ntdll里面，那么就没啥好说的了，直接无脑到返回，这个时候OD一直显示在nt，直到出现打印了一个提示信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Welcome to MRCTF 2021, wish you can catch the flag</span><br><span class="line">Please input your flag:</span><br></pre></td></tr></table></figure>
<p>然后整个程序就看到了00401751这个应该就是入口，直接就可以拖出来了，没啥太大的难度，然后想了一下是算法题，就直接用IDA打开就好，用OD反倒是没啥意思。<br>然后进去看main函数，大致上是这样子的：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">start</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v1; <span class="comment">// [esp+14h] [ebp-53Ch]</span></span><br><span class="line">  <span class="keyword">char</span> v2; <span class="comment">// [esp+15h] [ebp-53Bh]</span></span><br><span class="line">  <span class="keyword">char</span> v3; <span class="comment">// [esp+16h] [ebp-53Ah]</span></span><br><span class="line">  <span class="keyword">char</span> v4; <span class="comment">// [esp+17h] [ebp-539h]</span></span><br><span class="line">  <span class="keyword">char</span> v5; <span class="comment">// [esp+18h] [ebp-538h]</span></span><br><span class="line">  <span class="keyword">char</span> v6; <span class="comment">// [esp+19h] [ebp-537h]</span></span><br><span class="line">  <span class="keyword">char</span> v7; <span class="comment">// [esp+1Ah] [ebp-536h]</span></span><br><span class="line">  <span class="keyword">char</span> v8; <span class="comment">// [esp+1Bh] [ebp-535h]</span></span><br><span class="line">  <span class="keyword">char</span> v9; <span class="comment">// [esp+1Ch] [ebp-534h]</span></span><br><span class="line">  <span class="keyword">char</span> v10; <span class="comment">// [esp+1Dh] [ebp-533h]</span></span><br><span class="line">  <span class="keyword">char</span> v11; <span class="comment">// [esp+1Eh] [ebp-532h]</span></span><br><span class="line">  <span class="keyword">char</span> v12; <span class="comment">// [esp+1Fh] [ebp-531h]</span></span><br><span class="line">  <span class="keyword">char</span> v13; <span class="comment">// [esp+20h] [ebp-530h]</span></span><br><span class="line">  <span class="keyword">char</span> v14; <span class="comment">// [esp+21h] [ebp-52Fh]</span></span><br><span class="line">  <span class="keyword">char</span> v15; <span class="comment">// [esp+22h] [ebp-52Eh]</span></span><br><span class="line">  <span class="keyword">char</span> v16; <span class="comment">// [esp+23h] [ebp-52Dh]</span></span><br><span class="line">  <span class="keyword">char</span> v17; <span class="comment">// [esp+24h] [ebp-52Ch]</span></span><br><span class="line">  <span class="keyword">char</span> v18; <span class="comment">// [esp+25h] [ebp-52Bh]</span></span><br><span class="line">  <span class="keyword">char</span> v19; <span class="comment">// [esp+26h] [ebp-52Ah]</span></span><br><span class="line">  <span class="keyword">char</span> v20; <span class="comment">// [esp+27h] [ebp-529h]</span></span><br><span class="line">  <span class="keyword">char</span> v21; <span class="comment">// [esp+28h] [ebp-528h]</span></span><br><span class="line">  <span class="keyword">char</span> v22; <span class="comment">// [esp+29h] [ebp-527h]</span></span><br><span class="line">  <span class="keyword">char</span> v23; <span class="comment">// [esp+2Ah] [ebp-526h]</span></span><br><span class="line">  <span class="keyword">char</span> v24; <span class="comment">// [esp+2Bh] [ebp-525h]</span></span><br><span class="line">  <span class="keyword">char</span> v25; <span class="comment">// [esp+2Ch] [ebp-524h]</span></span><br><span class="line">  <span class="keyword">char</span> v26; <span class="comment">// [esp+2Dh] [ebp-523h]</span></span><br><span class="line">  <span class="keyword">char</span> v27; <span class="comment">// [esp+2Eh] [ebp-522h]</span></span><br><span class="line">  <span class="keyword">char</span> v28; <span class="comment">// [esp+2Fh] [ebp-521h]</span></span><br><span class="line">  <span class="keyword">char</span> v29; <span class="comment">// [esp+30h] [ebp-520h]</span></span><br><span class="line">  <span class="keyword">char</span> v30; <span class="comment">// [esp+31h] [ebp-51Fh]</span></span><br><span class="line">  <span class="keyword">char</span> v31; <span class="comment">// [esp+32h] [ebp-51Eh]</span></span><br><span class="line">  <span class="keyword">char</span> v32; <span class="comment">// [esp+33h] [ebp-51Dh]</span></span><br><span class="line">  <span class="keyword">char</span> v33; <span class="comment">// [esp+34h] [ebp-51Ch]</span></span><br><span class="line">  <span class="keyword">char</span> v34; <span class="comment">// [esp+35h] [ebp-51Bh]</span></span><br><span class="line">  <span class="keyword">char</span> v35; <span class="comment">// [esp+36h] [ebp-51Ah]</span></span><br><span class="line">  <span class="keyword">char</span> v36; <span class="comment">// [esp+37h] [ebp-519h]</span></span><br><span class="line">  <span class="keyword">char</span> v37; <span class="comment">// [esp+38h] [ebp-518h]</span></span><br><span class="line">  <span class="keyword">char</span> v38; <span class="comment">// [esp+39h] [ebp-517h]</span></span><br><span class="line">  <span class="keyword">char</span> v39; <span class="comment">// [esp+3Ah] [ebp-516h]</span></span><br><span class="line">  <span class="keyword">char</span> v40; <span class="comment">// [esp+3Bh] [ebp-515h]</span></span><br><span class="line">  <span class="keyword">char</span> v41; <span class="comment">// [esp+3Ch] [ebp-514h]</span></span><br><span class="line">  <span class="keyword">char</span> v42; <span class="comment">// [esp+3Dh] [ebp-513h]</span></span><br><span class="line">  <span class="keyword">char</span> v43; <span class="comment">// [esp+3Eh] [ebp-512h]</span></span><br><span class="line">  <span class="keyword">char</span> v44; <span class="comment">// [esp+3Fh] [ebp-511h]</span></span><br><span class="line">  <span class="keyword">char</span> Str; <span class="comment">// [esp+40h] [ebp-510h]</span></span><br><span class="line">  <span class="keyword">char</span> v46[<span class="number">1024</span>]; <span class="comment">// [esp+140h] [ebp-410h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v47; <span class="comment">// [esp+540h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">size_t</span> v48; <span class="comment">// [esp+544h] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">char</span> *v49; <span class="comment">// [esp+548h] [ebp-8h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> i; <span class="comment">// [esp+54Ch] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  sub_402290();</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Welcome to MRCTF 2021, wish you can catch the flag"</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Please input your flag:"</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;Str);</span><br><span class="line">  v49 = &amp;Str;</span><br><span class="line">  v48 = <span class="built_in">strlen</span>(&amp;Str);</span><br><span class="line">  v47 = sub_401500(v49, v48, v46);</span><br><span class="line">  v46[v47] = <span class="number">0</span>;</span><br><span class="line">  v1 = <span class="number">116</span>;</span><br><span class="line">  v2 = <span class="number">118</span>;</span><br><span class="line">  v3 = <span class="number">106</span>;</span><br><span class="line">  v4 = <span class="number">100</span>;</span><br><span class="line">  v5 = <span class="number">118</span>;</span><br><span class="line">  v6 = <span class="number">101</span>;</span><br><span class="line">  v7 = <span class="number">122</span>;</span><br><span class="line">  v8 = <span class="number">55</span>;</span><br><span class="line">  v9 = <span class="number">68</span>;</span><br><span class="line">  v10 = <span class="number">48</span>;</span><br><span class="line">  v11 = <span class="number">118</span>;</span><br><span class="line">  v12 = <span class="number">83</span>;</span><br><span class="line">  v13 = <span class="number">121</span>;</span><br><span class="line">  v14 = <span class="number">90</span>;</span><br><span class="line">  v15 = <span class="number">98</span>;</span><br><span class="line">  v16 = <span class="number">110</span>;</span><br><span class="line">  v17 = <span class="number">122</span>;</span><br><span class="line">  v18 = <span class="number">118</span>;</span><br><span class="line">  v19 = <span class="number">57</span>;</span><br><span class="line">  v20 = <span class="number">48</span>;</span><br><span class="line">  v21 = <span class="number">109</span>;</span><br><span class="line">  v22 = <span class="number">102</span>;</span><br><span class="line">  v23 = <span class="number">57</span>;</span><br><span class="line">  v24 = <span class="number">110</span>;</span><br><span class="line">  v25 = <span class="number">117</span>;</span><br><span class="line">  v26 = <span class="number">75</span>;</span><br><span class="line">  v27 = <span class="number">110</span>;</span><br><span class="line">  v28 = <span class="number">117</span>;</span><br><span class="line">  v29 = <span class="number">114</span>;</span><br><span class="line">  v30 = <span class="number">76</span>;</span><br><span class="line">  v31 = <span class="number">56</span>;</span><br><span class="line">  v32 = <span class="number">89</span>;</span><br><span class="line">  v33 = <span class="number">66</span>;</span><br><span class="line">  v34 = <span class="number">90</span>;</span><br><span class="line">  v35 = <span class="number">105</span>;</span><br><span class="line">  v36 = <span class="number">88</span>;</span><br><span class="line">  v37 = <span class="number">105</span>;</span><br><span class="line">  v38 = <span class="number">115</span>;</span><br><span class="line">  v39 = <span class="number">101</span>;</span><br><span class="line">  v40 = <span class="number">72</span>;</span><br><span class="line">  v41 = <span class="number">70</span>;</span><br><span class="line">  v42 = <span class="number">113</span>;</span><br><span class="line">  v43 = <span class="number">61</span>;</span><br><span class="line">  v44 = <span class="number">61</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v47; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v46[i] != *(&amp;v1 + i) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">printf</span>(<span class="string">"Sorry, plz try again"</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Jesus, You are so handsome!!"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>很明显的给出了一个加密之后的字符，但是出题人为了防止搜索字符串时候直接看到加密的内容，用这种比较麻烦的方法进行了小的保护，将那一长串的赋值进行编码之后是这样子的一个东西：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tvjdvez7D0vSyZbozv90mf9nuKnurL8YBZiXiseHFq&#x3D;&#x3D;</span><br></pre></td></tr></table></figure>
<p>这个让谁都会想到是base64，然后去网站解码一下发现出错了，这个时候我的傻子行为就开始了，简单阅读这段代码，发现<code>sub_401500</code>这个函数是我们的加密函数，就需要跟进去，然后代码就能看到了：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">sub_401500</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">unsigned</span> <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// ST08_4</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// ST08_4</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v12; <span class="comment">// ST08_4</span></span><br><span class="line">  <span class="keyword">int</span> v13; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v15; <span class="comment">// [esp+8h] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v16; <span class="comment">// [esp+8h] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v17; <span class="comment">// [esp+Ch] [ebp-8h]</span></span><br><span class="line"></span><br><span class="line">  v17 = <span class="number">0</span>;</span><br><span class="line">  v15 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( v17 + <span class="number">3</span> &lt;= a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = v15;</span><br><span class="line">    v4 = v15 + <span class="number">1</span>;</span><br><span class="line">    *(_BYTE *)(v3 + a3) = byte_403040[(<span class="keyword">signed</span> <span class="keyword">int</span>)*(<span class="keyword">unsigned</span> __int8 *)(a1 + v17) &gt;&gt; <span class="number">2</span>];</span><br><span class="line">    v5 = v4++;</span><br><span class="line">    *(_BYTE *)(v5 + a3) = byte_403040[<span class="number">16</span> * *(_BYTE *)(a1 + v17) &amp; <span class="number">0x30</span> | ((<span class="keyword">signed</span> <span class="keyword">int</span>)*(<span class="keyword">unsigned</span> __int8 *)(v17 + <span class="number">1</span> + a1) &gt;&gt; <span class="number">4</span>)];</span><br><span class="line">    *(_BYTE *)(v4 + a3) = byte_403040[<span class="number">4</span> * *(_BYTE *)(v17 + <span class="number">1</span> + a1) &amp; <span class="number">0x3C</span> | ((<span class="keyword">signed</span> <span class="keyword">int</span>)*(<span class="keyword">unsigned</span> __int8 *)(v17 + <span class="number">2</span> + a1) &gt;&gt; <span class="number">6</span>)];</span><br><span class="line">    v6 = v4 + <span class="number">1</span>;</span><br><span class="line">    v15 = v4 + <span class="number">2</span>;</span><br><span class="line">    *(_BYTE *)(v6 + a3) = byte_403040[*(_BYTE *)(v17 + <span class="number">2</span> + a1) &amp; <span class="number">0x3F</span>];</span><br><span class="line">    v17 += <span class="number">3</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v17 &lt; a2 )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( a2 - v17 == <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v7 = v15;</span><br><span class="line">      v8 = v15 + <span class="number">1</span>;</span><br><span class="line">      *(_BYTE *)(v7 + a3) = byte_403040[(<span class="keyword">signed</span> <span class="keyword">int</span>)*(<span class="keyword">unsigned</span> __int8 *)(a1 + v17) &gt;&gt; <span class="number">2</span>];</span><br><span class="line">      *(_BYTE *)(v8 + a3) = byte_403040[<span class="number">16</span> * *(_BYTE *)(a1 + v17) &amp; <span class="number">0x30</span>];</span><br><span class="line">      v9 = v8 + <span class="number">1</span>;</span><br><span class="line">      v16 = v8 + <span class="number">2</span>;</span><br><span class="line">      *(_BYTE *)(a3 + v9) = <span class="number">61</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v11 = v15;</span><br><span class="line">      v12 = v15 + <span class="number">1</span>;</span><br><span class="line">      *(_BYTE *)(v11 + a3) = byte_403040[(<span class="keyword">signed</span> <span class="keyword">int</span>)*(<span class="keyword">unsigned</span> __int8 *)(a1 + v17) &gt;&gt; <span class="number">2</span>];</span><br><span class="line">      *(_BYTE *)(v12 + a3) = byte_403040[<span class="number">16</span> * *(_BYTE *)(a1 + v17) &amp; <span class="number">0x30</span> | ((<span class="keyword">signed</span> <span class="keyword">int</span>)*(<span class="keyword">unsigned</span> __int8 *)(v17 + <span class="number">1</span> + a1) &gt;&gt; <span class="number">4</span>)];</span><br><span class="line">      v13 = v12 + <span class="number">1</span>;</span><br><span class="line">      v16 = v12 + <span class="number">2</span>;</span><br><span class="line">      *(_BYTE *)(v13 + a3) = byte_403040[<span class="number">4</span> * *(_BYTE *)(v17 + <span class="number">1</span> + a1) &amp; <span class="number">0x3C</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    v10 = v16;</span><br><span class="line">    v15 = v16 + <span class="number">1</span>;</span><br><span class="line">    *(_BYTE *)(a3 + v10) = <span class="number">61</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v15;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后我就开始分析了：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">*(_BYTE *)(v3 + a3) = byte_403040[(<span class="keyword">signed</span> <span class="keyword">int</span>)*(<span class="keyword">unsigned</span> __int8 *)(a1 + v17) &gt;&gt; <span class="number">2</span>];</span><br><span class="line">v5 = v4++;</span><br><span class="line">*(_BYTE *)(v5 + a3) = byte_403040[<span class="number">16</span> * *(_BYTE *)(a1 + v17) &amp; <span class="number">0x30</span> | ((<span class="keyword">signed</span> <span class="keyword">int</span>)*(<span class="keyword">unsigned</span> __int8 *)(v17 + <span class="number">1</span> + a1) &gt;&gt; <span class="number">4</span>)];</span><br><span class="line">*(_BYTE *)(v4 + a3) = byte_403040[<span class="number">4</span> * *(_BYTE *)(v17 + <span class="number">1</span> + a1) &amp; <span class="number">0x3C</span> | ((<span class="keyword">signed</span> <span class="keyword">int</span>)*(<span class="keyword">unsigned</span> __int8 *)(v17 + <span class="number">2</span> + a1) &gt;&gt; <span class="number">6</span>)];</span><br><span class="line">v6 = v4 + <span class="number">1</span>;</span><br><span class="line">v15 = v4 + <span class="number">2</span>;</span><br><span class="line">*(_BYTE *)(v6 + a3) = byte_403040[*(_BYTE *)(v17 + <span class="number">2</span> + a1) &amp; <span class="number">0x3F</span>];</span><br></pre></td></tr></table></figure>
<p>这段是将三个字符转化为4个字符，然后进行了一些位值操作，我就用C复现了一下：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">one</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> x&lt;&lt;<span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">two</span> <span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;<span class="number">64</span>;i++)&#123;</span><br><span class="line">		<span class="keyword">int</span> r = (((y * <span class="number">16</span>) &amp; <span class="number">0x30</span>) | (i &gt;&gt; <span class="number">4</span>));</span><br><span class="line">		<span class="comment">//printf("r:%d\n",r);</span></span><br><span class="line">		<span class="keyword">if</span>(r == x)&#123;</span><br><span class="line">			<span class="keyword">return</span> i;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> a[] = <span class="string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/"</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,one(<span class="number">52</span>));</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,two(<span class="number">3</span>,one(<span class="number">52</span>)));</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,<span class="number">0x31</span> &gt;&gt; <span class="number">2</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,((<span class="number">0x34</span> * <span class="number">16</span>) &amp; <span class="number">0x30</span>)  | (<span class="number">0x35</span> &gt;&gt; <span class="number">4</span>));</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,((<span class="number">0x32</span> * <span class="number">4</span>) &amp; <span class="number">0x3c</span>)  | (<span class="number">0x33</span> &gt;&gt; <span class="number">6</span>));</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,<span class="number">0x33</span> &amp; <span class="number">0x3F</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%c\n"</span>,a[<span class="number">0x31</span> &gt;&gt; <span class="number">2</span>]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%c\n"</span>,a[((<span class="number">0x31</span> * <span class="number">16</span>) &amp; <span class="number">0x30</span>)  | (<span class="number">0x32</span> &gt;&gt; <span class="number">4</span>)]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%c\n"</span>,a[((<span class="number">0x32</span> * <span class="number">4</span>) &amp; <span class="number">0x3c</span>)  | (<span class="number">0x33</span> &gt;&gt; <span class="number">6</span>)]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"%c"</span>,a[<span class="number">0x33</span> &amp; <span class="number">0x3F</span>]);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>读这段加密函数的时候里面的<code>byte_403040</code>就是我上面的a字符串，到这个时候我还没有想到要换码表，只是单纯的想把整个算法全部解出来。<br>我发现每三个一组，第二个值依靠于第三个值，第一个值只是一个移位，而且第二个值比较麻烦，我只能用到枚举方法进行解密，所以就有了我上面的<code>two</code>函数，然后手动枚举的时候发现出错了，然后测试了一个小时还是不对，到这个地方我就有点烦躁了，想一个签到题怎么会分析这么一个加密函数，会不会是一个成品的加密算法我不知道，到这个时候我还没想到是换表的base64，但是真的搞烦了，我就没继续做，晚上睡觉的时候觉得签到题没做出来真的太丢脸了，就又想了一下，后面有两个等号会是啥，突然想到应该是换表了，然后第二天就把他解出来了，确实好久没做了，感觉脑子有点跟不上了。<br>带一个网上搜索的换表代码吧：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"></span><br><span class="line">s = <span class="string">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/"</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">My_base64_encode</span><span class="params">(inputs)</span>:</span></span><br><span class="line">	<span class="comment"># 将字符串转化为2进制</span></span><br><span class="line">	bin_str = []</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> inputs:</span><br><span class="line">		x = str(bin(ord(i))).replace(<span class="string">'0b'</span>, <span class="string">''</span>)</span><br><span class="line">		bin_str.append(<span class="string">'&#123;:0&gt;8&#125;'</span>.format(x))</span><br><span class="line">	<span class="comment">#print(bin_str)</span></span><br><span class="line">	<span class="comment"># 输出的字符串</span></span><br><span class="line">	outputs = <span class="string">""</span></span><br><span class="line">	<span class="comment"># 不够三倍数，需补齐的次数</span></span><br><span class="line">	nums = <span class="number">0</span></span><br><span class="line">	<span class="keyword">while</span> bin_str:</span><br><span class="line">		<span class="comment">#每次取三个字符的二进制</span></span><br><span class="line">		temp_list = bin_str[:<span class="number">3</span>]</span><br><span class="line">		<span class="keyword">if</span>(len(temp_list) != <span class="number">3</span>):</span><br><span class="line">			nums = <span class="number">3</span> - len(temp_list)</span><br><span class="line">			<span class="keyword">while</span> len(temp_list) &lt; <span class="number">3</span>:</span><br><span class="line">				temp_list += [<span class="string">'0'</span> * <span class="number">8</span>]</span><br><span class="line">		temp_str = <span class="string">""</span>.join(temp_list)</span><br><span class="line">		<span class="comment">#print(temp_str)</span></span><br><span class="line">		<span class="comment"># 将三个8字节的二进制转换为4个十进制</span></span><br><span class="line">		temp_str_list = []</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">4</span>):</span><br><span class="line">			temp_str_list.append(int(temp_str[i*<span class="number">6</span>:(i+<span class="number">1</span>)*<span class="number">6</span>],<span class="number">2</span>))</span><br><span class="line">		<span class="comment">#print(temp_str_list)</span></span><br><span class="line">		<span class="keyword">if</span> nums:</span><br><span class="line">			temp_str_list = temp_str_list[<span class="number">0</span>:<span class="number">4</span> - nums]</span><br><span class="line">			</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> temp_str_list:</span><br><span class="line">			outputs += s[i]</span><br><span class="line">		bin_str = bin_str[<span class="number">3</span>:]</span><br><span class="line">	outputs += nums * <span class="string">'='</span></span><br><span class="line">	print(<span class="string">"Encrypted String:\n%s "</span>%outputs)</span><br><span class="line">	</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">My_base64_decode</span><span class="params">(inputs)</span>:</span></span><br><span class="line">	<span class="comment"># 将字符串转化为2进制</span></span><br><span class="line">	bin_str = []</span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> inputs:</span><br><span class="line">		<span class="keyword">if</span> i != <span class="string">'='</span>:</span><br><span class="line">			x = str(bin(s.index(i))).replace(<span class="string">'0b'</span>, <span class="string">''</span>)</span><br><span class="line">			bin_str.append(<span class="string">'&#123;:0&gt;6&#125;'</span>.format(x))</span><br><span class="line">	<span class="comment">#print(bin_str)</span></span><br><span class="line">	<span class="comment"># 输出的字符串</span></span><br><span class="line">	outputs = <span class="string">""</span></span><br><span class="line">	nums = inputs.count(<span class="string">'='</span>)</span><br><span class="line">	<span class="keyword">while</span> bin_str:</span><br><span class="line">		temp_list = bin_str[:<span class="number">4</span>]</span><br><span class="line">		temp_str = <span class="string">""</span>.join(temp_list)</span><br><span class="line">		<span class="comment">#print(temp_str)</span></span><br><span class="line">		<span class="comment"># 补足8位字节</span></span><br><span class="line">		<span class="keyword">if</span>(len(temp_str) % <span class="number">8</span> != <span class="number">0</span>):</span><br><span class="line">			temp_str = temp_str[<span class="number">0</span>:<span class="number">-1</span> * nums * <span class="number">2</span>]</span><br><span class="line">		<span class="comment"># 将四个6字节的二进制转换为三个字符</span></span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,int(len(temp_str) / <span class="number">8</span>)):</span><br><span class="line">			outputs += chr(int(temp_str[i*<span class="number">8</span>:(i+<span class="number">1</span>)*<span class="number">8</span>],<span class="number">2</span>))</span><br><span class="line">		bin_str = bin_str[<span class="number">4</span>:]	</span><br><span class="line">	print(<span class="string">"Decrypted String:\n%s "</span>%outputs)</span><br><span class="line">	</span><br><span class="line">print()</span><br><span class="line">print(<span class="string">"     *************************************"</span>)</span><br><span class="line">print(<span class="string">"     *    (1)encode         (2)decode    *"</span>)	</span><br><span class="line">print(<span class="string">"     *************************************"</span>)</span><br><span class="line">print()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">num = input(<span class="string">"Please select the operation you want to perform:\n"</span>)</span><br><span class="line"><span class="keyword">if</span>(num == <span class="string">"1"</span>):</span><br><span class="line">	input_str = input(<span class="string">"Please enter a string that needs to be encrypted: \n"</span>)</span><br><span class="line">	My_base64_encode(input_str)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	input_str = input(<span class="string">"Please enter a string that needs to be decrypted: \n"</span>)</span><br><span class="line">	My_base64_decode(input_str)</span><br></pre></td></tr></table></figure>

<h2 id="安卓入门题"><a href="#安卓入门题" class="headerlink" title="安卓入门题"></a>安卓入门题</h2><p>这个题目其实是在我没想到换表base64的时候他就发给我了，主要是我觉得入签到题没做出来有点丢脸，我就再要一个找回点面子，他就给我发来了安卓的一个签到题，用jadx打开看了一下，非常好，没有加壳，没有混淆，反调试我没看，但是应该也是没有的，那么这个题目就应该手到擒来了。</p>
<p>我用我的模拟器安装都提示失败了，其实实际上是我的安卓版本不够，他需要的sdk版本应该比较高，但是我又懒得再下载一个新的模拟器了，所以就直接静态分析吧，进来之后看到包很多，找到MainActivity，发现没有什么验证的东西，只是有这么一句代码：<code>editText2.addTextChangedListener(new MainActivity$onCreate$1(this, editText2, button, editText));</code>想了一下应该是输入框输入完之后才会允许点击，那就跟进去这个匿名内部类看一下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onTextChanged</span><span class="params">(CharSequence charSequence, <span class="keyword">int</span> i, <span class="keyword">int</span> i2, <span class="keyword">int</span> i3)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.$password.length() == <span class="number">39</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.$button.setEnabled(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">this</span>.$button.setOnClickListener(<span class="keyword">new</span> MainActivity$onCreate$<span class="number">1</span>$onTextChanged$<span class="number">1</span>(<span class="keyword">this</span>));</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.$button.setEnabled(<span class="keyword">false</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>确实是password等于39的时候才会允许点击按钮，所以说密码是39位，然后找到按钮点击的匿名内部类，看一下里面是啥：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">    EditText editText = <span class="keyword">this</span>.<span class="keyword">this</span>$<span class="number">0</span>.$username;</span><br><span class="line">    Intrinsics.checkNotNullExpressionValue(editText, <span class="string">"username"</span>);</span><br><span class="line">    Object obj = editText.getText().toString();</span><br><span class="line">    EditText editText2 = <span class="keyword">this</span>.<span class="keyword">this</span>$<span class="number">0</span>.$password;</span><br><span class="line">    Intrinsics.checkNotNullExpressionValue(editText2, <span class="string">"password"</span>);</span><br><span class="line">    String obj2 = editText2.getText().toString();</span><br><span class="line">    String str = <span class="string">"Wrong pass!"</span>;</span><br><span class="line">    <span class="keyword">if</span> (Intrinsics.areEqual(obj, (Object) <span class="string">"MRCTF"</span>)) &#123;</span><br><span class="line">        String str2 = <span class="string">"null cannot be cast to non-null type java.lang.String"</span>;</span><br><span class="line">        Objects.requireNonNull(obj2, str2);</span><br><span class="line">        String substring = obj2.substring(<span class="number">6</span>, <span class="number">13</span>);</span><br><span class="line">        String str3 = <span class="string">"(this as java.lang.Strin…ing(startIndex, endIndex)"</span>;</span><br><span class="line">        Intrinsics.checkNotNullExpressionValue(substring, str3);</span><br><span class="line">        <span class="keyword">if</span> (Intrinsics.areEqual(MainActivityKt.encode(substring), (Object) <span class="string">"f5e69f42b7a9a0f1c9edede743a1d27f"</span>)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (Intrinsics.areEqual(obj2.subSequence(<span class="number">0</span>, <span class="number">6</span>), (Object) <span class="string">"MRCTF&#123;"</span>) &amp;&amp; Intrinsics.areEqual(obj2.subSequence(obj2.length() - <span class="number">1</span>, obj2.length()), (Object) <span class="string">"&#125;"</span>)) &#123;</span><br><span class="line">                MainActivity mainActivity = <span class="keyword">this</span>.<span class="keyword">this</span>$<span class="number">0</span>.<span class="keyword">this</span>$<span class="number">0</span>;</span><br><span class="line">                <span class="keyword">int</span> length = obj2.length() - <span class="number">1</span>;</span><br><span class="line">                Objects.requireNonNull(obj2, str2);</span><br><span class="line">                str2 = obj2.substring(<span class="number">13</span>, length);</span><br><span class="line">                Intrinsics.checkNotNullExpressionValue(str2, str3);</span><br><span class="line">                <span class="keyword">if</span> (mainActivity.check2(str2) == <span class="number">1</span>) &#123;</span><br><span class="line">                    Toast.makeText(<span class="keyword">this</span>.<span class="keyword">this</span>$<span class="number">0</span>.<span class="keyword">this</span>$<span class="number">0</span>.getApplicationContext(), <span class="string">"Right pass!"</span>, <span class="number">0</span>).show();</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    Toast.makeText(<span class="keyword">this</span>.<span class="keyword">this</span>$<span class="number">0</span>.<span class="keyword">this</span>$<span class="number">0</span>.getApplicationContext(), str, <span class="number">0</span>).show();</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            Toast.makeText(<span class="keyword">this</span>.<span class="keyword">this</span>$<span class="number">0</span>.<span class="keyword">this</span>$<span class="number">0</span>.getApplicationContext(), str, <span class="number">0</span>).show();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Toast.makeText(<span class="keyword">this</span>.<span class="keyword">this</span>$<span class="number">0</span>.<span class="keyword">this</span>$<span class="number">0</span>.getApplicationContext(), str, <span class="number">0</span>).show();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后可以看到，他先是获取了输入框的内容，然后比较了一下username是不是等于MRCTF，说明username是MRCTF，然后继续分析可以看到他截取了6,13的密码的值，是一段很像md5的一个值，是通过encode进行加密的，然后跟进这个encode去看一下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String <span class="title">encode</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">    Intrinsics.checkNotNullParameter(str, <span class="string">"plain"</span>);</span><br><span class="line">    MessageDigest instance = MessageDigest.getInstance(<span class="string">"MD5"</span>);</span><br><span class="line">    Intrinsics.checkNotNullExpressionValue(instance, <span class="string">"MessageDigest.getInstance(\"MD5\")"</span>);</span><br><span class="line">    Object bytes = str.getBytes(Charsets.UTF_8);</span><br><span class="line">    Intrinsics.checkNotNullExpressionValue(bytes, <span class="string">"(this as java.lang.String).getBytes(charset)"</span>);</span><br><span class="line">    bytes = instance.digest(bytes);</span><br><span class="line">    Intrinsics.checkNotNullExpressionValue(bytes, <span class="string">"instance.digest(plain.toByteArray())"</span>);</span><br><span class="line">    StringBuffer stringBuffer = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">byte</span> b : bytes) &#123;</span><br><span class="line">        String toHexString = Integer.toHexString(b &amp; <span class="number">255</span>);</span><br><span class="line">        Intrinsics.checkNotNullExpressionValue(toHexString, <span class="string">"Integer.toHexString(hex)"</span>);</span><br><span class="line">        <span class="keyword">if</span> (toHexString.length() &lt; <span class="number">2</span>) &#123;</span><br><span class="line">            toHexString = <span class="string">'0'</span> + toHexString;</span><br><span class="line">        &#125;</span><br><span class="line">        stringBuffer.append(toHexString);</span><br><span class="line">    &#125;</span><br><span class="line">    str = stringBuffer.toString();</span><br><span class="line">    Intrinsics.checkNotNullExpressionValue(str, <span class="string">"buff.toString()"</span>);</span><br><span class="line">    <span class="keyword">return</span> str;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这就很明显了，就是一个典型的MD5加密算法，需要去解密一下，这个值，cmd5付费，发现一个somd5不要钱就可以得到结果，那么这个值就解决了。<br>继续回到onclick里面，发现他又判断两边的内容是不是”MRCTF{“和”}”，两边的值也确定了，然后看到下面还有一个check2的判断方法，截取的是中间部分剩下的，那说明这是最后一个加密了。<br>跟进去这个check2，发现是这样子的一段代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">check2</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">    Intrinsics.checkNotNullParameter(str, <span class="string">"part2"</span>);</span><br><span class="line">    <span class="keyword">int</span>[] iArr = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">110</span>, <span class="number">82</span>, <span class="number">89</span>, <span class="number">87</span>, <span class="number">86</span>, <span class="number">95</span>, <span class="number">6</span>, <span class="number">94</span>, <span class="number">105</span>, <span class="number">71</span>, <span class="number">80</span>, <span class="number">92</span>, <span class="number">83</span>, <span class="number">4</span>, <span class="number">93</span>, <span class="number">85</span>, <span class="number">111</span>, <span class="number">65</span>, <span class="number">93</span>, <span class="number">111</span>, <span class="number">124</span>, <span class="number">98</span>, <span class="number">115</span>, <span class="number">100</span>, <span class="number">118</span>&#125;;</span><br><span class="line">    rand rand = <span class="keyword">new</span> rand(srand1, srand2);</span><br><span class="line">    <span class="keyword">int</span> length = str.length();</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> i2 = i;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; length) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((str.charAt(i) ^ StringsKt___StringsKt.first(rand.next(rand.getMemory()))) != iArr[i2]) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        i2++;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>打眼一看他自己写的类只有两个，一个<code>rand</code>，一个<code>StringsKt___StringsKt</code>，先看rand：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">rand</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span>[] memory;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">rand</span><span class="params">(<span class="keyword">long</span> j, <span class="keyword">long</span> j2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.memory = <span class="keyword">new</span> <span class="keyword">long</span>[]&#123;j, j2&#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">long</span>[] getMemory() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.memory;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">setMemory</span><span class="params">(<span class="keyword">long</span>[] jArr)</span> </span>&#123;</span><br><span class="line">        Intrinsics.checkNotNullParameter(jArr, <span class="string">"&lt;set-?&gt;"</span>);</span><br><span class="line">        <span class="keyword">this</span>.memory = jArr;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> String <span class="title">next</span><span class="params">(<span class="keyword">long</span>[] jArr)</span> </span>&#123;</span><br><span class="line">        Intrinsics.checkNotNullParameter(jArr, <span class="string">"memory"</span>);</span><br><span class="line">        <span class="keyword">long</span> j = jArr[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">long</span> j2 = jArr[<span class="number">1</span>];</span><br><span class="line">        jArr[<span class="number">0</span>] = j2;</span><br><span class="line">        j ^= j &lt;&lt; <span class="number">23</span>;</span><br><span class="line">        jArr[<span class="number">1</span>] = ((j &gt;&gt;&gt; <span class="number">17</span>) ^ (j ^ j2)) ^ (j2 &gt;&gt;&gt; <span class="number">26</span>);</span><br><span class="line">        String valueOf = String.valueOf(jArr[<span class="number">1</span>] + j2);</span><br><span class="line">        String str = <span class="string">"null cannot be cast to non-null type java.lang.String"</span>;</span><br><span class="line">        Objects.requireNonNull(valueOf, str);</span><br><span class="line">        Object substring = valueOf.substring(<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">        String str2 = <span class="string">"(this as java.lang.Strin…ing(startIndex, endIndex)"</span>;</span><br><span class="line">        Intrinsics.checkNotNullExpressionValue(substring, str2);</span><br><span class="line">        <span class="keyword">if</span> (Intrinsics.areEqual(substring, (Object) <span class="string">"-"</span>)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"0"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        String valueOf2 = String.valueOf(jArr[<span class="number">1</span>] + j2);</span><br><span class="line">        Objects.requireNonNull(valueOf2, str);</span><br><span class="line">        valueOf2 = valueOf2.substring(<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">        Intrinsics.checkNotNullExpressionValue(valueOf2, str2);</span><br><span class="line">        <span class="keyword">return</span> valueOf2;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>代码很简单，就是将传进来的两个long值进行一顿操作再就没了。这个也是可以直接复制的。<br>那么继续看<code>StringsKt___StringsKt.first</code>这个方法是啥：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">char</span> <span class="title">first</span><span class="params">(CharSequence charSequence)</span> </span>&#123;</span><br><span class="line">    Intrinsics.checkNotNullParameter(charSequence, <span class="string">"$this$first"</span>);</span><br><span class="line">    <span class="keyword">if</span> ((charSequence.length() == <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> charSequence.charAt(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> NoSuchElementException(<span class="string">"Char sequence is empty."</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>也是很简单，到此为止我们就解决了所有的未知方法，但是这个check2方法还需要两个long的值，是在MainActivity中进行定义的：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">long</span> srand1 = <span class="number">202120212021L</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">long</span> srand2 = <span class="number">114514114514L</span>;</span><br></pre></td></tr></table></figure>
<p>好了，这些东西都解决了，那么就是反推结果了，可以看到check2方法只有满足：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ((str.charAt(i) ^ StringsKt___StringsKt.first(rand.next(rand.getMemory()))) != iArr[i2]) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>
<p>这个的时候返回0，也就是错误，那么我们就让他不满足，看到是一个异或，那么直接反过来得到str的每个字符，最终我们就可以得到最终的结果，自己写个小脚本：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">long</span> srand1 = <span class="number">202120212021L</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">long</span> srand2 = <span class="number">114514114514L</span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">char</span> <span class="title">first</span><span class="params">(CharSequence charSequence)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">if</span> ((charSequence.length() == <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>) == <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> charSequence.charAt(<span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">check2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">int</span>[] iArr = <span class="keyword">new</span> <span class="keyword">int</span>[] &#123; <span class="number">110</span>, <span class="number">82</span>, <span class="number">89</span>, <span class="number">87</span>, <span class="number">86</span>, <span class="number">95</span>, <span class="number">6</span>, <span class="number">94</span>, <span class="number">105</span>, <span class="number">71</span>, <span class="number">80</span>, <span class="number">92</span>, <span class="number">83</span>, <span class="number">4</span>, <span class="number">93</span>, <span class="number">85</span>, <span class="number">111</span>, <span class="number">65</span>, <span class="number">93</span>, <span class="number">111</span>, <span class="number">124</span>,</span><br><span class="line">			<span class="number">98</span>, <span class="number">115</span>, <span class="number">100</span>, <span class="number">118</span> &#125;;</span><br><span class="line">	rand rand = <span class="keyword">new</span> rand(srand1, srand2);</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">int</span> i2 = i;</span><br><span class="line">	String out = <span class="string">""</span>;</span><br><span class="line">	<span class="keyword">while</span> (i &lt; iArr.length) &#123;</span><br><span class="line">		out += (<span class="keyword">char</span>)(first(rand.next(rand.getMemory()))^iArr[i2]);</span><br><span class="line">		System.out.println(out);</span><br><span class="line">		i2++;</span><br><span class="line">		i++;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>打印出最终的中间部分，正当我觉得大功告成的时候，他和我说flag不对，我觉得判断是没有任何错误的，到此为止已经到十一点了，第二天还要体测，不能睡的太晚，我就没有继续去搞他。<br>到了第二天，我就回过头来再看了一下这段代码，发现了一个蹊跷，实际上在<code>oncreate</code>方法执行的时候他还执行了一个<code>jni.test()</code>，我没去注意，觉得签到题不应该牵扯到so吧，而且我还忽略了一个问题，就是在MainActivity里面还有一个内部类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">Companion</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Companion</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">long</span> <span class="title">getSrand1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> MainActivity.srand1;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">setSrand1</span><span class="params">(<span class="keyword">long</span> j)</span> </span>&#123;</span><br><span class="line">        MainActivity.srand1 = j;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">long</span> <span class="title">getSrand2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> MainActivity.srand2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">setSrand2</span><span class="params">(<span class="keyword">long</span> j)</span> </span>&#123;</span><br><span class="line">        MainActivity.srand2 = j;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@JvmStatic</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">int</span> <span class="title">SetSrand</span><span class="params">(<span class="keyword">long</span> j, <span class="keyword">long</span> j2)</span> </span>&#123;</span><br><span class="line">        MainActivity.Companion.setSrand1(j);</span><br><span class="line">        MainActivity.Companion.setSrand2(j2);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>他操作的时候Srand这两个值，这是唯一的在java层操作这个值的一个类，就考虑到可能是这个类修改了这两个值，但是没有任何一个地方调用了这个方法，很有可能是在so中进行的操作，然后我就拖出了so文件，简单分析了一下，里面有一个加密算法，但是看的有点长：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">signed <span class="keyword">int</span> __cdecl <span class="title">com_example_mrcheckin_jni_test</span><span class="params">(_JNIEnv *a1, unsigned __int8 *a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  signed __int32 v2; <span class="comment">// eax</span></span><br><span class="line">  __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  signed <span class="keyword">int</span> v4; <span class="comment">// ecx</span></span><br><span class="line">  __int64 v5; <span class="comment">// kr10_8</span></span><br><span class="line">  unsigned <span class="keyword">int</span> v6; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// kr20_4</span></span><br><span class="line">  signed <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  signed <span class="keyword">int</span> i; <span class="comment">// [esp+1Ch] [ebp-70h]</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// [esp+20h] [ebp-6Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// [esp+20h] [ebp-6Ch]</span></span><br><span class="line">  unsigned <span class="keyword">int</span> v12; <span class="comment">// [esp+24h] [ebp-68h]</span></span><br><span class="line">  unsigned <span class="keyword">int</span> v13; <span class="comment">// [esp+24h] [ebp-68h]</span></span><br><span class="line">  __int64 v14; <span class="comment">// [esp+28h] [ebp-64h]</span></span><br><span class="line">  unsigned __int64 v15; <span class="comment">// [esp+38h] [ebp-54h]</span></span><br><span class="line">  unsigned __int64 v16; <span class="comment">// [esp+40h] [ebp-4Ch]</span></span><br><span class="line">  __int64 v17; <span class="comment">// [esp+48h] [ebp-44h]</span></span><br><span class="line">  <span class="keyword">int</span> v18; <span class="comment">// [esp+50h] [ebp-3Ch]</span></span><br><span class="line">  <span class="keyword">char</span> v19; <span class="comment">// [esp+54h] [ebp-38h]</span></span><br><span class="line">  __int64 v20; <span class="comment">// [esp+58h] [ebp-34h]</span></span><br><span class="line">  __int64 v21; <span class="comment">// [esp+60h] [ebp-2Ch]</span></span><br><span class="line">  __int64 v22; <span class="comment">// [esp+68h] [ebp-24h]</span></span><br><span class="line">  __int64 v23; <span class="comment">// [esp+70h] [ebp-1Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v24; <span class="comment">// [esp+78h] [ebp-14h]</span></span><br><span class="line"></span><br><span class="line">  v19 = <span class="number">0</span>;</span><br><span class="line">  v18 = <span class="number">825372722</span>;</span><br><span class="line">  <span class="keyword">if</span> ( !(strlen((<span class="keyword">const</span> <span class="keyword">char</span> *)a2) &amp; <span class="number">7</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    v17 = strlen((<span class="keyword">const</span> <span class="keyword">char</span> *)a2) &gt;&gt; <span class="number">3</span>;</span><br><span class="line">    v12 = <span class="number">0</span>;</span><br><span class="line">    v10 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> ( v12 &lt; <span class="number">4</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      v2 = _byteswap_ulong(*(<span class="keyword">int</span> *)((<span class="keyword">char</span> *)&amp;v18 + v10));</span><br><span class="line">      *((_DWORD *)&amp;v20 + <span class="number">2</span> * v12) = v2;</span><br><span class="line">      *((_DWORD *)&amp;v20 + <span class="number">2</span> * v12++ + <span class="number">1</span>) = v2 &gt;&gt; <span class="number">31</span>;</span><br><span class="line">      v10 += <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    v13 = <span class="number">0</span>;</span><br><span class="line">    v11 = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> ( v13 &lt; (signed __int64)(unsigned <span class="keyword">int</span>)v17 )</span><br><span class="line">    &#123;</span><br><span class="line">      v14 = <span class="number">0L</span>L;</span><br><span class="line">      v16 = (signed <span class="keyword">int</span>)_byteswap_ulong(*(_DWORD *)&amp;a2[v11]);</span><br><span class="line">      v15 = (signed <span class="keyword">int</span>)_byteswap_ulong(*(_DWORD *)&amp;a2[v11 + (_DWORD)(&amp;dword_A6E4 - <span class="number">10680</span>)]);</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">34</span>; ++i )</span><br><span class="line">      &#123;</span><br><span class="line">        v14 += <span class="number">2654435769L</span>L;</span><br><span class="line">        HIDWORD(v3) = ((v21 + __PAIR__(SHIDWORD(v15) &gt;&gt; <span class="number">5</span>, (unsigned <span class="keyword">int</span>)(v15 &gt;&gt; <span class="number">5</span>))) &gt;&gt; <span class="number">32</span>) ^ ((v14 + v15) &gt;&gt; <span class="number">32</span>) ^ ((v20 + <span class="number">16</span> * v15) &gt;&gt; <span class="number">32</span>);</span><br><span class="line">        LODWORD(v3) = v16;</span><br><span class="line">        v4 = (__PAIR__(HIDWORD(v16), (v21 + (v15 &gt;&gt; <span class="number">5</span>)) ^ (v14 + v15) ^ (v20 + <span class="number">16</span> * v15)) + v3) &gt;&gt; <span class="number">32</span>;</span><br><span class="line">        LODWORD(v3) = ((v21 + (v15 &gt;&gt; <span class="number">5</span>)) ^ (v14 + v15) ^ (v20 + <span class="number">16</span> * v15)) + v16;</span><br><span class="line">        v16 = __PAIR__(v4, (unsigned <span class="keyword">int</span>)v3);</span><br><span class="line">        HIDWORD(v3) = v4;</span><br><span class="line">        v5 = v22 + <span class="number">16</span> * v3;</span><br><span class="line">        v6 = (v14 + v3) ^ v5;</span><br><span class="line">        v7 = v23 + (__PAIR__((unsigned <span class="keyword">int</span>)v4, (unsigned <span class="keyword">int</span>)v3) &gt;&gt; <span class="number">5</span>);</span><br><span class="line">        HIDWORD(v3) = ((v23</span><br><span class="line">                      + __PAIR__(</span><br><span class="line">                          (unsigned <span class="keyword">int</span>)(v4 &gt;&gt; <span class="number">5</span>),</span><br><span class="line">                          (unsigned <span class="keyword">int</span>)(__PAIR__((unsigned <span class="keyword">int</span>)v4, (unsigned <span class="keyword">int</span>)v3) &gt;&gt; <span class="number">5</span>))) &gt;&gt; <span class="number">32</span>) ^ ((v14 + __PAIR__((unsigned <span class="keyword">int</span>)v4, (unsigned <span class="keyword">int</span>)v3)) &gt;&gt; <span class="number">32</span>) ^ HIDWORD(v5);</span><br><span class="line">        LODWORD(v3) = v15;</span><br><span class="line">        v15 = __PAIR__(HIDWORD(v15), v7 ^ v6) + v3;</span><br><span class="line">      &#125;</span><br><span class="line">      a2[v11] = BYTE3(v16);</span><br><span class="line">      a2[v11 + <span class="number">1</span>] = BYTE2(v16);</span><br><span class="line">      a2[v11 + <span class="number">2</span>] = BYTE1(v16);</span><br><span class="line">      a2[v11 + <span class="number">3</span>] = v16;</span><br><span class="line">      a2[v11 + <span class="number">4</span>] = BYTE3(v15);</span><br><span class="line">      a2[v11 + <span class="number">5</span>] = BYTE2(v15);</span><br><span class="line">      a2[v11 + <span class="number">6</span>] = BYTE1(v15);</span><br><span class="line">      a2[v11 + <span class="number">7</span>] = v15;</span><br><span class="line">      ++v13;</span><br><span class="line">      v11 += <span class="number">8</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  result = <span class="number">42720</span>;</span><br><span class="line">  <span class="keyword">if</span> ( _stack_chk_guard != v24 )</span><br><span class="line">    JUMPOUT(*(_DWORD *)JNI_OnLoad);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>，就想着直接用他的这个so文件导入到我的安卓项目中看看他是否能直接将我的srand进行修改，然后我就得到修改之后的srand，然后我在操作的时候发现执行<code>jni.test()</code>的时候会报错，然后我又跟进so查看，发现它在jni_onload的时候执行了一个函数：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">_BOOL4 __<span class="function">cdecl <span class="title">sub_6340</span><span class="params">(_JNIEnv *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> sub_7380(a1, <span class="string">"com/example/mrcheckin/jni"</span>, (<span class="keyword">int</span>)&amp;off_B920, <span class="number">1</span>) != <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>应该是一个根据程序操作的一个方法，然后我就按照程序的名字修改了我的项目进行测试，但是还是会报错，具体什么错误也没仔细去看了，反正解决了一大顿也没解决好，到这里思路终止了，我不能动态调试，属实是太着急人了，所以我就不得不全装一个新版本的安卓模拟器去执行这个程序然后找到被修改之后的srand，我先下载的夜神，安装上一个hook框架之后直接就崩了，我又下载了一个新版本的雷电模拟器，我之前的hook框架在雷电可以运行，所以我就用的雷电模拟器。<br>一切正常，那个安卓程序也可以安装成功了。<br>这个时候本想动态调试的，但是想了想还是直接hook吧，这样子会简单一些，现在我们hook的方法有许多：</p>
<ol>
<li>hook rand类的构造函数，获取传递进来的srand值</li>
<li>hook check2方法，在执行的时候获取到srand值</li>
</ol>
<p>我选择了后者，其实主要是想偷懒。<br>那么我就写了一个hook代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.msg;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> de.robv.android.xposed.XposedHelpers.findAndHookMethod;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.util.Log;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.IXposedHookLoadPackage;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.XC_MethodHook;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.XposedBridge;</span><br><span class="line"><span class="keyword">import</span> de.robv.android.xposed.callbacks.XC_LoadPackage.LoadPackageParam;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestMain</span> <span class="keyword">implements</span> <span class="title">IXposedHookLoadPackage</span> </span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleLoadPackage</span><span class="params">(LoadPackageParam lpparam)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">		XposedBridge.log(lpparam.packageName);</span><br><span class="line">		XposedBridge.log(lpparam.packageName);</span><br><span class="line">		<span class="keyword">if</span> (!lpparam.packageName.equals(<span class="string">"com.example.mrcheckin"</span>))</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		Log.d(<span class="string">"wker"</span>, <span class="string">"into"</span>);</span><br><span class="line">		findAndHookMethod(<span class="string">"com.example.mrcheckin.MainActivity"</span>, lpparam.classLoader, <span class="string">"check2"</span>, String<span class="class">.<span class="keyword">class</span>,</span></span><br><span class="line"><span class="class">				<span class="title">new</span> <span class="title">XC_MethodHook</span>() </span>&#123;</span><br><span class="line">					<span class="meta">@Override</span></span><br><span class="line">					<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">afterHookedMethod</span><span class="params">(MethodHookParam param)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">					&#125;</span><br><span class="line"></span><br><span class="line">					<span class="meta">@Override</span></span><br><span class="line">					<span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">beforeHookedMethod</span><span class="params">(MethodHookParam param)</span> <span class="keyword">throws</span> Throwable </span>&#123;</span><br><span class="line">						Class clazz = param.thisObject.getClass();</span><br><span class="line">						XposedBridge.log(<span class="string">"LoadClass : "</span>+clazz.getName());</span><br><span class="line">						Field[] fields = clazz.getDeclaredFields();</span><br><span class="line">						<span class="keyword">for</span>(<span class="keyword">int</span> f=<span class="number">0</span>;f &lt; fields.length;f++)&#123;</span><br><span class="line">						       fields[f].setAccessible(<span class="keyword">true</span>);</span><br><span class="line">						       XposedBridge.log( fields[f].getName());</span><br><span class="line">						       <span class="keyword">if</span>(fields[f].getName().equals(<span class="string">"srand1"</span>) || fields[f].getName().equals(<span class="string">"srand2"</span>))&#123;</span><br><span class="line">						    	   Long password = (Long) fields[f].get(param.thisObject);</span><br><span class="line">						    	   XposedBridge.log(String.valueOf(password));</span><br><span class="line">						       &#125;</span><br><span class="line">						&#125;</span><br><span class="line">					&#125;</span><br><span class="line">				&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这里需要注意的是，这个srand是private的，所以我们需要<code>setAccessible</code>进行处理一下。<br>最终可以在日志中看到：<br><img src="3.jpg" alt="srand"><br>将这两个值重新放入到我们的脚本中最终可以得到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">_</span><br><span class="line">_c</span><br><span class="line">_ch</span><br><span class="line">_che</span><br><span class="line">_chec</span><br><span class="line">_check</span><br><span class="line">_check1</span><br><span class="line">_check1n</span><br><span class="line">_check1n_</span><br><span class="line">_check1n_w</span><br><span class="line">_check1n_we</span><br><span class="line">_check1n_wel</span><br><span class="line">_check1n_welc</span><br><span class="line">_check1n_welc0</span><br><span class="line">_check1n_welc0m</span><br><span class="line">_check1n_welc0me</span><br><span class="line">_check1n_welc0me_</span><br><span class="line">_check1n_welc0me_t</span><br><span class="line">_check1n_welc0me_to</span><br><span class="line">_check1n_welc0me_to_</span><br><span class="line">_check1n_welc0me_to_M</span><br><span class="line">_check1n_welc0me_to_MR</span><br><span class="line">_check1n_welc0me_to_MRC</span><br><span class="line">_check1n_welc0me_to_MRCT</span><br><span class="line">_check1n_welc0me_to_MRCTF</span><br></pre></td></tr></table></figure>
<p>然后最终拼接到我们之前的flag中，最终的flag就出来了。</p>
<h2 id="反思"><a href="#反思" class="headerlink" title="反思"></a>反思</h2><p>真的是社会在进步了，思想有点落后了，还把自己高中时候的水平带到现在高中时候的水平，盲目狂妄自大只会让我一步步的掉入坑中，脚踏实地才是我们应该做的。</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/CTF/" rel="tag"># CTF</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/11/14/%E7%BE%A4%E6%99%BA%E8%83%BD%E7%AE%97%E6%B3%95/" rel="prev" title="群智能算法">
      <i class="fa fa-chevron-left"></i> 群智能算法
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#CTF入门题"><span class="nav-number">1.</span> <span class="nav-text">CTF入门题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#exe逆向"><span class="nav-number">1.1.</span> <span class="nav-text">exe逆向</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#安卓入门题"><span class="nav-number">1.2.</span> <span class="nav-text">安卓入门题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#反思"><span class="nav-number">1.3.</span> <span class="nav-text">反思</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Wker"
      src="/images/Image.JPG">
  <p class="site-author-name" itemprop="name">Wker</p>
  <div class="site-description" itemprop="description">一个萌新</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">133</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Wker</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.7.0
  </div>



<br/>
        
        <span id="busuanzi_container_site_pv">
                本站总访问量<span id="busuanzi_value_site_pv"></span>次
        </span>
        <span class="post-meta-divider">|</span>
        <span id="busuanzi_container_site_uv" style='display:none'>
                本站访客数<span id="busuanzi_value_site_uv"></span>人
        </span>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

  
  <script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
  
</body>
</html>
